{"version":3,"file":"flicking.cjs.js","sources":["../src/react-flicking/Clone.tsx","../src/react-flicking/consts.ts","../src/react-flicking/utils.ts","../src/react-flicking/Flicking.tsx"],"sourcesContent":["import { Component } from \"react\";\n\nexport class CloneComponent extends Component {\n  public render() {\n    return this.props.children;\n  }\n}\n","import { ChangeEvent, FlickingEvent, FlickingOptions, SelectEvent, NeedPanelEvent } from \"@egjs/flicking\";\nimport { FlickingProps } from \"./types\";\n\nexport const DEFAULT_OPTIONS: FlickingOptions = {\n  classPrefix: \"eg-flick\",\n  deceleration: 0.0075,\n  horizontal: true,\n  circular: false,\n  infinite: false,\n  infiniteThreshold: 0,\n  threshold: 40,\n  duration: 100,\n  panelEffect: x => 1 - Math.pow(1 - x, 3),\n  defaultIndex: 0,\n  inputType: [\"touch\", \"mouse\"],\n  thresholdAngle: 45,\n  bounce: 10,\n  autoResize: false,\n  adaptive: false,\n  zIndex: 2000,\n  bound: false,\n  overflow: false,\n  hanger: \"50%\",\n  anchor: \"50%\",\n  gap: 0,\n  moveType: { type: \"snap\", count: 1 },\n  lastIndex: Infinity,\n  renderExternal: true,\n};\n\nexport const FLICKING_PROPS: FlickingProps = {\n  tag: \"div\",\n  classPrefix: \"eg-flick\",\n  plugins: [],\n  onNeedPanel: (e: NeedPanelEvent) => {},\n  onMoveStart: (e: FlickingEvent) => {},\n  onMove: (e: FlickingEvent) => {},\n  onMoveEnd: (e: FlickingEvent) => {},\n  onHoldStart: (e: FlickingEvent) => {},\n  onHoldEnd: (e: FlickingEvent) => {},\n  onRestore: (e: FlickingEvent) => {},\n  onSelect: (e: SelectEvent) => {},\n  onChange: (e: ChangeEvent) => {},\n};\n","import Flicking from \"@egjs/flicking\";\n\n// tslint:disable-next-line: naming-convention\nexport function MappingFlicking<T extends new (...args: any[]) => {}>() {\n  const flickingPrototype = Flicking.prototype;\n\n  return (constructor: T) => {\n      const prototype = constructor.prototype;\n\n      Object.keys(flickingPrototype).forEach(name => {\n        const method = flickingPrototype[name];\n\n        if (typeof method === \"function\") {\n          prototype[name] = function(...args) {\n            const result = this.flicking[name](...args);\n\n            if (result === this.flicking) {\n              return this;\n            } else {\n              return result;\n            }\n          };\n        }\n      });\n  };\n}\n","import NativeFlicking, { FlickingOptions, FlickingPanel, FlickingStatus, Plugin, FlickingEvent, NeedPanelEvent } from \"@egjs/flicking\";\nimport * as React from \"react\";\nimport { findDOMNode } from \"react-dom\";\nimport ChildrenDiffer from \"@egjs/react-children-differ\";\nimport { CloneComponent } from \"./Clone\";\nimport { DEFAULT_OPTIONS, FLICKING_PROPS } from \"./consts\";\nimport { FlickingProps, FlickingType } from \"./types\";\nimport ListDiffer from \"@egjs/list-differ\";\nimport { ChildrenDiffResult } from \"@egjs/children-differ\";\nimport { MappingFlicking } from \"./utils\";\n\n@MappingFlicking()\nclass Flicking extends React.Component<Partial<FlickingProps & FlickingOptions>> {\n  public static defaultProps: FlickingProps = FLICKING_PROPS;\n  public state: {\n    cloneCount: number,\n  } = {\n      cloneCount: 0,\n    };\n  // Flicking\n  private flicking?: NativeFlicking | null;\n  private options: FlickingOptions = {\n    ...DEFAULT_OPTIONS,\n  };\n  // differ\n  private pluginsDiffer: ListDiffer<Plugin> = new ListDiffer<Plugin>();\n  // life cycle\n  public render() {\n    const props = this.props;\n    // tslint:disable-next-line:naming-convention\n    const Tag = props.tag as any;\n    const classPrefix = props.classPrefix;\n    const options = this.options;\n    const attributes: { [key: string]: any } = {};\n\n    for (const name in props) {\n      if (name in DEFAULT_OPTIONS) {\n        options[name] = props[name];\n      } else if (!(name in FLICKING_PROPS)) {\n        attributes[name] = props[name];\n      }\n    }\n    return (\n      <Tag {...attributes}>\n        <div className={`${classPrefix}-viewport`}>\n          <div className={`${classPrefix}-camera`}>\n            <ChildrenDiffer onUpdate={this.onUpdate}>\n              {this.renderPanels()}\n            </ChildrenDiffer>\n          </div>\n        </div>\n      </Tag>\n    );\n  }\n  public onUpdate = (result: ChildrenDiffResult<HTMLElement>) => {\n    if (typeof this.props.lastIndex === \"number\") {\n      this.setLastIndex(this.props.lastIndex!);\n    }\n    this.flicking!.sync(result as ChildrenDiffResult<HTMLElement>);\n    this.checkPlugins();\n    this.checkCloneCount();\n  }\n  public componentDidMount() {\n    this.flicking = new NativeFlicking(\n      findDOMNode(this) as HTMLElement,\n      this.options,\n    ).on({\n      moveStart: (e: FlickingEvent) => this.props.onMoveStart!(e),\n      move: (e: FlickingEvent) => this.props.onMove!(e),\n      moveEnd: (e: FlickingEvent) => this.props.onMoveEnd!(e),\n      holdStart: (e: FlickingEvent) => this.props.onHoldStart!(e),\n      holdEnd: (e: FlickingEvent) => this.props.onHoldEnd!(e),\n      select: (e: FlickingEvent) => this.props.onSelect!(e),\n      needPanel: (e: NeedPanelEvent) => this.props.onNeedPanel!(e),\n      change: (e: FlickingEvent) => this.props.onChange!(e),\n      restore: (e: FlickingEvent) => this.props.onRestore!(e),\n    });\n\n    if (this.props.status) {\n      this.setStatus(this.props.status);\n    }\n    this.checkPlugins();\n    this.checkCloneCount();\n  }\n  public componentWillUnmount() {\n    this.destroy();\n  }\n  // private\n  private checkPlugins() {\n    const { list, added, removed, prevList } = this.pluginsDiffer.update(this.props.plugins!);\n\n    this.addPlugins(added.map(index => list[index]));\n    this.removePlugins(removed.map(index => prevList[index]));\n  }\n  private checkCloneCount() {\n    const cloneCount = this.flicking!.getCloneCount();\n\n    if (this.state.cloneCount !== cloneCount) {\n      this.setState({\n        cloneCount,\n      });\n    }\n  }\n  private renderPanels() {\n    const length = this.state.cloneCount;\n    const children = React.Children.toArray(this.props.children) as Array<React.ReactElement<any>>;\n    let arr: Array<React.ReactElement<any>> = [...children];\n\n    for (let i = 0; i < length; ++i) {\n      arr = arr.concat(children.map(el => {\n        return <CloneComponent key={`clone${i}${el.key}`}>{el}</CloneComponent>;\n      }));\n    }\n    return arr;\n  }\n}\ninterface Flicking extends React.Component<Partial<FlickingProps & FlickingOptions>>, FlickingType<Flicking> {\n\n}\n\nexport default Flicking;\n"],"names":["tslib_1","props","children","Component","DEFAULT_OPTIONS","classPrefix","deceleration","horizontal","circular","infinite","infiniteThreshold","threshold","duration","panelEffect","x","Math","pow","defaultIndex","inputType","thresholdAngle","bounce","autoResize","adaptive","zIndex","bound","overflow","hanger","anchor","gap","moveType","type","count","lastIndex","Infinity","renderExternal","FLICKING_PROPS","tag","plugins","onNeedPanel","e","onMoveStart","onMove","onMoveEnd","onHoldStart","onHoldEnd","onRestore","onSelect","onChange","MappingFlicking","flickingPrototype","Flicking","prototype","constructor","Object","keys","forEach","name","method","_i","args","result","_a","flicking","_this","cloneCount","ListDiffer","setLastIndex","sync","checkPlugins","checkCloneCount","Tag","options","attributes","React","className","ChildrenDiffer","onUpdate","renderPanels","NativeFlicking","findDOMNode","on","moveStart","move","moveEnd","holdStart","holdEnd","select","needPanel","change","restore","status","setStatus","destroy","list","added","removed","prevList","addPlugins","map","index","removePlugins","getCloneCount","state","setState","length","toArray","arr","i","concat","el","CloneComponent","key"],"mappings":"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"}